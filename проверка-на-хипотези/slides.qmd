---
title: "Проверка на хипотези"
author: "Виктор Аврамов"
format:
  revealjs:
    incremental: true   
editor: visual
---

## Един сценарий {.scrollable}

Нека допуснем, че сте мениджъри във фирма за търговия на дребно и обмисляте да стартирате нова маркетингова кампания, насочена към увеличаване на продажбите. Преди да стартирате кампанията в цялата страна, вие решавате да я тествате в два региона: Регион А и Регион Б. След месец данните за продажбите и от двата региона се събират. Забелязвате, че регион А, където е била реализирана кампанията, показва увеличение на продажбите в сравнение с регион Б, където кампанията не е била проведена.

Ключовият въпрос е: **"Увеличението на продажбите дължи ли се на новата маркетингова кампания или може да се дължи на случайност?"**

Тестването на хипотези позволява да решите дали да приемете или отхвърлите нулевата хипотеза, която в този случай може да бъде: **"Маркетинговата кампания няма ефект върху продажбите."**


## Стъпки в тестването на хипотези {.scrollable}

- ### 1. Формулиране на хипотезите:

- При тестване на хипотези започваме с две взаимно изклюващи се хипотези:
- **Нулева хипотеза ($H_0$):** Твърдение за липса на взаимовръзка или разлика.
- **Алтернативна хипотеза ($H_a$):** Твърдение, което искаме да тестваме спрямо нулевата хипотеза, за наличие на взаимовръзка или разлика.

- **Пример:**
- $H_0$: Маркетинговата кампания няма ефект върху продажбите.
- $H_a$: Маркетинговата кампания увеличава продажбите.

- ### 2. Избор на ниво на значимост ($\alpha$):

- Нивото на значимост, което означаваме с $\alpha$, е вероятността за отхвърляне на нулевата хипотеза, когато тя действително е вярна. Често срещаните избори са $\alpha = 0,05$ или $\alpha = 0,01$.

- ### 3. Избор на подходяща тестова статистика:

- Статистиката на теста зависи от вида на данните и конкретния тест на хипотезата, който се извършва (напр. Z-тест, Т-тест). Тестовата статистика помага да се определи вероятността за наблюдение на данните, с които разполагаме, когато нулевата хипотеза е вярна.

- ### 4. Определяне на правилото за вземане на решение:

- Въз основа на нивото на значимост и разпределението на тестовата статистика ние определяме критичната стойност(и) или прага на p-стойността за отхвърляне на нулевата хипотеза.

- ### 5. Изчисляване на тестовата статистика и вземане на решение:

- Използвайки извадковите данни,с които разполагаме, изчисляваме тестовата статистика и я сравняваме с критичната стойност или оценяваме p-стойността:
- Ако тестовата статистика попада в критичната област или p-стойността е по-малка от $\alpha$, отхвърляме $H_0$.
- В противен случай не успяваме да отхвърлим $H_0$.

## Видове грешки {.scrollable}

- ### Грешка от I тип (фалшиво положително):

- Възниква, когато отхвърлим нулевата хипотеза ($H_0$), когато тя действително е вярна.
- Вероятността за допускане на грешка от I тип се обозначава с $\alpha$.

- ### Грешка от II тип (фалшиво отрицателно):

- Възниква, когато не успеем да отхвърлим нулевата хипотеза ($H_0$), когато тя всъщност е невярна.
- Вероятността за допускане на грешка от II тип се обозначава с $\beta$.

- ### Балансиране на грешки от  I тип и II тип:

- Намаляването на $\alpha$ намалява вероятността от грешка от I тип, но увеличава вероятността от грешка от тип II и обратно.
- Изборът на $\alpha$ зависи от контекста и последствията от допускането на всеки тип грешка.


## Едностранни и двустранни тестове {.scrollable}

- ### Едностранен тест:

- Използва се, когато алтернативната хипотеза ($H_a$) указва посоката на ефекта.
- Пример: $H_a$: Маркетинговата кампания увеличава продажбите.

- ### Двустранен тест:

- Използва се, когато алтернативната хипотеза ($H_a$) не уточнява посоката на ефекта.
- Пример: $H_a$: Маркетинговата кампания има ефект върху продажбите (увеличава или намалява).

- ### Употреба:

- Едностранните тестове се използват, когато допускаме конкретна посока.
- Двустранните тестове се използват, когато търсим значима разлика, независимо от посоката.

- ### Примери:

- Едностранно: Тестване дали ново лекарство се представя по-добре от съществуващото.
- Двустранен: Тестване дали нова маркетингова стратегия има различно въздействие върху продажбите в сравнение със старата стратегия.

## Пример: Z-тест с една извадка {.scrollable}

- ### Нека имаме следния сценарий:

- Компания твърди, че новата им енергийна напитка увеличава средното работно време, в което служителите са продуктивни, до повече от 8 часа на ден. За да се провери това твърдение, е взета случайна извадка от 30 служители и е установено, че средното им работно време е 8,2 часа със стандартно отклонение от 0,5 часа. Тестваме това твърдение при ниво на значимост $\alpha = 0,05$.

- ### Стъпки:

1. **Формулиране на хипотезите:**
    - Нулева хипотеза ($H_0$): $\mu \leq 8$
    - Алтернативна хипотеза ($H_a$): $\mu > 8$

2. **Избор на ниво на значимост ($\alpha$):**
    - $\alpha = 0,05$

3. **Избор на подходяща тестова статистика:**
    - Тъй като размерът на извадката е голям ($n = 30$), използваме Z-теста.
    - Тестова статистика: $Z = \frac{\bar{X} - \mu_0}{\sigma / \sqrt{n}}$

4. **Определяне на правилото за приемане на заключение:**
    - Критична стойност за $\alpha = 0,05$ в едностранен тест: $Z_{0,05} = 1,645$
    - Правило за приемане на заключение: Отхвърляме $H_0$, ако $Z > 1,645$

5. **Изчисляваме тестовата статистика и правим заключение:**
    - Средна стойност на извадката ($\bar{X}$): 8.2
    - Средно стойност за всички сужители (популация) $H_0$ ($\mu_0$): 8
    - Стандартно отклонение ($\sigma$): 0,5
    - Размер на извадката ($n$): 30
    - $Z = \frac{8,2 - 8}{0,5 / \sqrt{30}} = \frac{0,2}{0,0913} \approx 2,19$
    - Тъй като $2,19 > 1,645$, ние отхвърляме $H_0$.
    
    

## Проверка на хипотези {.scrollable}

### Z-тест:

- Използва се за тестване на средната стойност на популация, когато размерът на извадката е голям ($n > 30$) или дисперсията на популацията е известна.
- Пример:
   - Нашата компания твърди, че тяхната нова енергийна напитка увеличава средното работно време на служителите до повече от 8 часа на ден. 
   - Размер на извадката ($n$): 30
   - Примерна средна ($\bar{X}$): 8,2 часа
   - Стандартно отклонение на популацията ($\sigma$): 0,5 часа
   - Хипотези:
     - $H_0$: $\mu \leq 8$
     - $H_a$: $\mu > 8$
   - Тестова статистика: $Z = \frac{\bar{X} - \mu_0}{\sigma / \sqrt{n}} = \frac{8,2 - 8}{0,5 / \sqrt{30}} = 2,19$
   - Ниво на значимост ($\alpha$): 0,05
   - Критична стойност за $\alpha = 0,05$ в едностранен тест: $Z_{0,05} = 1,645$
   - Решение: Тъй като $2,19 > 1,645$, отхвърляме $H_0$.

### Т-тест:

- Използва се за тестване на средната стойност на популация, когато размерът на извадката е малък ($n \leq 30$) и дисперсията на популацията е неизвестна.
- Видове Т-тестове:
   - **T-тест с една извадка:** Сравнява средната стойност на извадката с известна стойност.
   - **T-тест с две извадки:** Сравнява средните стойности на две независими групи от данни.
   - **Сдвоен Т-тест:** Сравнява средните стойности от една и съща група по различно време.
- Пример (Т-тест с една извадка):
   - Една компания иска да тества дали средните месечни продажби на техния продукт се различават от индустриалния стандарт от $5000.
   - Размер на извадката ($n$): 15
   - Примерна средна стойност ($\bar{X}$): 5300
   - Примерно стандартно отклонение ($s$): 600
   - Хипотези:
     - $H_0$: $\mu = 5000$
     - $H_a$: $\mu \neq 5000$
   - Тестова статистика: $t = \frac{\bar{X} - \mu_0}{s / \sqrt{n}} = \frac{5300 - 5000}{600 / \sqrt{15}} = 2,58$
   - Степени на свобода ($df$): $n - 1 = 14$
   - Ниво на значимост ($\alpha$): 0,05
   - Критична стойност за $\alpha = 0,05$ в двустранен тест: $t_{0,025, 14} \approx 2,145$
   - Решение: Тъй като $2,58 > 2,145$, отхвърляме $H_0$.    
    
    
## P-стойност и ниво на значимост {.scrollable}

- ### P-стойност:

- P-стойността е вероятността за получаване на тестова статистика, поне толкова екстремна, колкото наблюдаваната, като се приеме, че нулевата хипотеза ($H_0$) е вярна.
- Малка p-стойност показва убедителни доказателства срещу нулевата хипотеза.

- ### Ниво на значимост ($\alpha$):

- Нивото на значимост, често означавано с $\alpha$, е прагът, при който решаваме дали да отхвърлим нулевата хипотеза.
- Общите нива на значимост са 0,05 (5%) и 0,01 (1%).

- ### Изчисляване на P-стойността:

- За Z-тест p-стойността се изчислява с помощта на стандартното нормално разпределение.
- Пример: Да предположим, че нашата тестова статистика е $Z = 2,19$.
- За едностранен тест p-стойността е областта вдясно от $Z$:
   - $p\text{-стойност} = P(Z > 2,19)$
   - Използване на стандартни таблици за нормално разпределение или калкулатор: $p\text{-стойност} \approx 0,0143$
- За двустранен тест удвоете едностранната p-стойност:
   - $p\text{-стойност} = 2 \times P(Z > 2,19)$
   - $p\text{-стойност} \approx 2 \times 0,0143 = 0,0286$

- ### Пример:

- Да предположим, че в предишния ни числен пример сме изчислили p-стойност от 0,015.
- Тъй като 0,015 < 0,05, отхвърляме $H_0$.
- Тъй като 0,015 < 0,05, отхвърляме $H_0$.



## Допускания при тестване на хипотези {.scrollable}

### Нормалност:

- Данните трябва да бъдат приблизително нормално разпределени, особено за малки размери на извадката.
- **Пример:** За Т-тест допускането е, че извадката идва от популация, която има нормално разпределение.

### Независимост:

- Наблюденията в извадката трябва да са независими едно от друго.
- **Пример:** В анкета всеки респондент трябва да отговаря самостоятелно, без да влияе на другите.

### Хомогенност на дисперсията:

- Разликите в различните сравнявани групи трябва да са приблизително равни.
- **Пример:** За ANOVA тест разликите в различните групи трябва да са подобни.

### Случайна извадка:

- Извадката трябва да бъде избрана на случаен принцип от популацията.
- **Пример:** За да се обобщят резултатите за по-голяма съвкупност, извадката трябва да представя популацията точно чрез случаен подбор.

### Голям размер на извадката:

- Някои тестове, като Z-теста, предполагат голям размер на извадката.
- **Пример:** За Z-тест размер на извадката над 30 обикновено се счита за достатъчен.


